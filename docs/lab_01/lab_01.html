
<!DOCTYPE html>


<html lang="fr" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Laboratoire 1 --- Introduction &#8212; Documentation DRV 2025 </title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/color.css?v=8770e769" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=72dce1d2"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/translations.js?v=bf059b8c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lab_01/lab_01';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Mise en place de SSH sur la carte" href="../helper/ssh.html" />
    <link rel="prev" title="Laboratoire 0 --- Consolidation du langage C" href="../lab_00/lab_00.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Passer au contenu principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Haut de page</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Alerte de version"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_drv.png" class="logo__image only-light" alt="Documentation DRV 2025  - Home"/>
    <img src="../_static/logo_drv.png" class="logo__image only-dark pst-js-only" alt="Documentation DRV 2025  - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Recherche</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../helper/helper.html">Helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../helper/eval_criterion.html">Consigne de rendu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab_00/lab_00.html">Laboratoire 0</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Laboratoire 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../helper/ssh.html">Mise en place SSH</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Téléchargez cette page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lab_01/lab_01.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Télécharger le fichier source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimer au format PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Mode plein écran"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Thème" data-bs-title="Thème"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Clair"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Sombre"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="Paramètres système"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Laboratoire 1 --- Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenu </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs">Objectifs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-de-l-environnement-de-developpement-et-prise-en-main-de-la-carte-de1-soc">Préparation de l'environnement de développement et prise en main de la carte DE1-SoC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#premieres-interactions-hw-sw">Premières interactions HW-SW</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#materiel-necessaire">Matériel nécessaire</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Préparation de l'environnement de développement et prise en main de la carte DE1-SoC</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#presentation-de-la-carte-de1-soc">Présentation de la carte DE1-SoC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-de-la-carte">Préparation de la carte</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-du-pc">Configuration du PC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-de-la-carte-sd">Préparation de la carte SD</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connexion-console-a-la-carte">Connexion console à la carte</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-des-serveurs-nfs-et-tftp">Configuration des serveurs NFS et TFTP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-reseau-de-la-machine-virtuelle">Configuration réseau de la machine virtuelle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametrage-reseau-sur-la-machine-hote">Paramétrage réseau sur la machine hôte</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-et-utilisation-de-u-boot">Configuration et utilisation de U-Boot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-des-toolchains">Vérification des toolchains</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compilation-sur-la-cible-native">Compilation sur la cible (native)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compilation-croisee-sous-de1-soc">Compilation croisée sous DE1-SoC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acces-aux-peripheriques-du-cyclonev-soc-depuis-u-boot">Accès aux périphériques du CycloneV-SoC depuis U-Boot</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exemple">Exemple</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acces-aux-peripheriques-du-de1-soc-depuis-linux">Accès aux périphériques du DE1-SoC depuis Linux</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#travail-a-rendre-et-criteres-d-evaluation">Travail à rendre et critères d'évaluation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="laboratoire-1-introduction">
<span id="laboratoire1"></span><h1>Laboratoire 1 --- Introduction<a class="headerlink" href="#laboratoire-1-introduction" title="Lien vers cette rubrique">#</a></h1>
<p>Le but de ces laboratoires est de vous familiariser avec les méthodologies de développement pour la création de drivers.
En effet (comme pour beaucoup de choses dans la vie réelle), il y a un gros décalage entre ce qu'on peut connaître sur la
théorie du fonctionnement d'un système d'exploitation et l'application de ces concepts dans la pratique.
En particulier, les drivers se situent dans une couche assez délicate, car ils sont à l'interface entre le monde utilisateur et le
matériel sous-jacent, donc ils sont affectés par les erreurs des deux mondes.</p>
<p>Dans ces consignes on vous invitera souvent à pousser vos investigations plus loin.
Essayez de donner une réponse par vous-mêmes aux questions qu'on vous posera,
cela vous aidera à mieux comprendre le sujet !</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il est souvent très très difficile comprendre si une erreur est liée à une mauvaise manipulation au niveau logiciel utilisateur,
à un bug dans le driver, à un bug du hardware, ... !</p>
</div>
<section id="objectifs">
<h2>Objectifs<a class="headerlink" href="#objectifs" title="Lien vers cette rubrique">#</a></h2>
<section id="preparation-de-l-environnement-de-developpement-et-prise-en-main-de-la-carte-de1-soc">
<h3>Préparation de l'environnement de développement et prise en main de la carte DE1-SoC<a class="headerlink" href="#preparation-de-l-environnement-de-developpement-et-prise-en-main-de-la-carte-de1-soc" title="Lien vers cette rubrique">#</a></h3>
<ul class="simple">
<li><p>Configurer l'écosystème de développement pour le cours DRV</p></li>
<li><p>Communiquer avec la carte via le réseau et la console</p></li>
<li><p>Connaître les fonctionnalités de base de U-Boot</p></li>
<li><p>Utiliser U-Boot afin d'interagir directement avec les périphériques de la DE1-SoC</p></li>
<li><p>Utiliser la toolchain de cross-compilation Linux afin de produire des exécutables destinés à la distribution Linux de la DE1-SoC</p></li>
</ul>
</section>
<section id="premieres-interactions-hw-sw">
<h3>Premières interactions HW-SW<a class="headerlink" href="#premieres-interactions-hw-sw" title="Lien vers cette rubrique">#</a></h3>
<ul class="simple">
<li><p>Manipuler le hardware DE1-SoC depuis un logiciel userspace</p></li>
</ul>
</section>
</section>
<section id="materiel-necessaire">
<h2>Matériel nécessaire<a class="headerlink" href="#materiel-necessaire" title="Lien vers cette rubrique">#</a></h2>
<p>Dans ce laboratoire on préparera l'écosystème de développement qu'on utilisera pour toute la durée du cours.</p>
<p>Pour cela, il vous faudra télécharger les éléments suivants :</p>
<ul class="simple">
<li><p>une toolchain de cross-compilation Linux (déjà installée sur les machines de laboratoire et dans la
machine virtuelle). On utilisera une toolchain de Linaro, que vous pouvez
télécharger <a class="reference external" href="https://releases.linaro.org/components/toolchain/binaries/6.4-2018.05/arm-linux-gnueabihf/gcc-linaro-6.4.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz">ici</a></p></li>
<li><p>une archive <code class="file docutils literal notranslate"><span class="pre">drv-2025-boot.tar.gz</span></code> contenant les fichiers nécessaires au boot de la DE1-SoC [disponible <a class="reference external" href="http://reds-data.heig-vd.ch/cours/2025_drv/drv-2025-boot.tar.gz">ici</a>]</p></li>
<li><p>une archive <code class="file docutils literal notranslate"><span class="pre">drv-2025-sdcard.tar.gz</span></code> contenant une image d'une carte SD pour la DE1-SoC [disponible <a class="reference external" href="http://reds-data.heig-vd.ch/cours/2025_drv/drv-2025-sdcard.tar.gz">ici</a>]</p></li>
<li><p>la documentation Altera, disponible dans le git du laboratoire (<code class="file docutils literal notranslate"><span class="pre">material/lab_01/</span></code>).</p></li>
</ul>
</section>
<section id="id1">
<h2>Préparation de l'environnement de développement et prise en main de la carte DE1-SoC<a class="headerlink" href="#id1" title="Lien vers cette rubrique">#</a></h2>
<section id="presentation-de-la-carte-de1-soc">
<h3>Présentation de la carte DE1-SoC<a class="headerlink" href="#presentation-de-la-carte-de1-soc" title="Lien vers cette rubrique">#</a></h3>
<p>La carte <a class="reference external" href="https://www.terasic.com.tw/cgi-bin/page/archive.pl?Language=English&amp;No=836">DE1-SoC</a>
est une carte de développement robuste et low-cost qui intègre un processeur ARM Cortex-A9 (dual core)
avec une FPGA (grâce au chip <a class="reference external" href="https://www.intel.com/content/www/us/en/products/programmable/soc/cyclone-v.html">Cyclone V SoC</a>).</p>
<p>Dans ce cours on se focalisera sur le processeur ARM (aussi appelé HPS -- <em>Hard Processor System</em>).
Dans d'autres cours vous pourrez découvrir comment faire interagir ce processeur avec la partie FPGA
(aussi appelée PL -- <em>Programmable Logic</em>).</p>
<p>Au début du cours on utilisera l'image crée par Intel-Altera dans le contexte du
<a class="reference external" href="https://www.intel.com/content/www/us/en/developer/topic-technology/fpga-academic/overview.html">Intel-Altera University Program</a>.
On customisera ensuite le noyau pour répondre à nos besoins.</p>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Les outputs des commandes montrés ci-dessous sont ce que j'obtiens sur <strong>ma</strong> machine.
Ces textes changent d'une machine à l'autre, si vous utilisez une machine virtuelle,
si vous avez fait des mises à jour, ...
Regardez donc ce qui le texte <strong>dit</strong>, et non seulement s'il est identique à ce qui
est noté ci-dessous !!!</p>
</div>
</section>
<section id="preparation-de-la-carte">
<h3>Préparation de la carte<a class="headerlink" href="#preparation-de-la-carte" title="Lien vers cette rubrique">#</a></h3>
<p>Avant d'allumer la carte, assurez-vous que les switches du MODE SELECT (MSEL) sous
la carte soient comme dans la figure ci-dessous.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/msel.png"><img alt="../_images/msel.png" src="../_images/msel.png" style="width: 6cm;" /></a>
</figure>
<p>Ces switches sont utilisés pour dire à la DE1-SoC comment la FPGA sera configurée.
Avec la configuration ci-dessus, ce sera Linux qui se chargera de la tâche.</p>
</section>
<section id="configuration-du-pc">
<h3>Configuration du PC<a class="headerlink" href="#configuration-du-pc" title="Lien vers cette rubrique">#</a></h3>
<p>Pour la suite du cours, on partira du principe que vous travaillez sous Linux
--- soit avec une machine virtuelle/machine de laboratoire, soit avec votre ordinateur portable.
Pour la connexion avec la carte, il faut que votre carte réseau ait l'adresse <strong>192.168.0.1</strong>.
La DE1-SoC aura, elle, l'adresse <strong>192.168.0.2</strong>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Les commandes ci-dessous ont été testées dans une distribution de
Linux Ubuntu-like.
Des différences sont possibles si vous utilisez une autre
distribution.</p>
</div>
</section>
<section id="preparation-de-la-carte-sd">
<h3>Préparation de la carte SD<a class="headerlink" href="#preparation-de-la-carte-sd" title="Lien vers cette rubrique">#</a></h3>
<p>Une fois téléchargé l'archive contenant l'image de la carte SD, vous devez identifier le dispositif associé avec le lecteur de cartes avec la commande <strong>dmesg</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>dmesg
<span class="go">...</span>
<span class="go">130088.305550] sd 6:0:0:1: [sde] 31422464 512-byte logical blocks: (16.1 GB/15.0 GiB)</span>
<span class="go">[130088.306567] sd 6:0:0:1: [sde] Write Protect is off</span>
<span class="go">[130088.306575] sd 6:0:0:1: [sde] Mode Sense: 2f 00 00 00</span>
<span class="go">[130088.307716] sd 6:0:0:1: [sde] Write cache: disabled, read cache: enabled, doesn&#39;t support DPO or FUA</span>
<span class="go">[130088.313749]  sde: sde1 sde2 sde3</span>
<span class="go">[130088.316561] sd 6:0:0:1: [sde] Attached SCSI removable disk</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/skull.png"><img alt="../_images/skull.png" src="../_images/skull.png" style="width: 6cm;" /></a>
</figure>
<p>Dans <strong>mon</strong> cas, il s'agit de <code class="file docutils literal notranslate"><span class="pre">/dev/sde</span></code>. FAITES BIEN ATTENTION AU NOM QUE
<strong>VOUS</strong> OBTENEZ !</p>
<p><span class="boldred">Dans la commande ci-dessous, il faudra remplacer</span>
<code class="file docutils literal notranslate"><span class="pre">VOTREDISPOSITIF</span></code>
<span class="boldred">avec le nom du dispositif que vous avez obtenu grâce à dmesg.</span></p>
<p>Vous pourrez ainsi préparer la carte avec les commandes :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>tar<span class="w"> </span>xzvf<span class="w"> </span>drv-2025-sdcard.tar.gz
<span class="gp">HOST:~$ </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>drv-2024-sdcard.img<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/VOTREDISPOSITIF<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>4M<span class="w"> </span><span class="nv">conv</span><span class="o">=</span>fsync<span class="w"> </span><span class="nv">status</span><span class="o">=</span>progress
</pre></div>
</div>
<p>Replacez la carte SD dans la board DE1-SoC une fois la copie terminée !</p>
<p>Vous trouverez davantage d'informations sur la commande <code class="code docutils literal notranslate"><span class="pre">dd</span></code> <a class="reference external" href="https://en.wikipedia.org/wiki/Dd_(Unix)">ici</a>.</p>
</section>
<section id="connexion-console-a-la-carte">
<h3>Connexion console à la carte<a class="headerlink" href="#connexion-console-a-la-carte" title="Lien vers cette rubrique">#</a></h3>
<p>La connexion à la console série se fait sur le connecteur mini-USB situé près du lecteur de cartes SD.
Sur le même côté, une prise Ethernet est aussi disponible.
Connectez la carte et mettez-la sous tension.</p>
<p>Vérifiez d'abord que la carte soit bien détectée par l'ordinateur à l'aide de la commande <code class="code highlight bash docutils literal highlight-bash">lsusb</code>.
La réponse devrait contenir la ligne suivante :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Bus 001 Device 008: ID 0403:6001 Future Technology Devices International, Ltd FT232 USB-Serial (UART) IC
</pre></div>
</div>
<p>Le convertisseur série/USB de la DE1-SoC apparaît sous la forme d'un fichier <code class="file docutils literal notranslate"><span class="pre">ttyUSBX</span></code> dans le répertoire <code class="file docutils literal notranslate"><span class="pre">/dev</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>C'est où sur la carte ce chip ? N'hésitez pas à explorer les composants sur la
carte à l'aide de la feuille incluse dans la boîte de la carte !</p>
</div>
<p>Utilisez l'outil <strong>picocom</strong> (ou <strong>minicom</strong>, si vous le préférez) afin d'ouvrir une session de terminal avec la carte.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>picocom<span class="w"> </span>-b<span class="w"> </span><span class="m">115200</span><span class="w"> </span>/dev/ttyUSB0
</pre></div>
</div>
<p>Si vous avez des soucis de permissions, cela veut dire que l'utilisateur local n'est pas dans le groupe <strong>dialout</strong>.
Vous pouvez vérifier cela avec la commande <code class="code highlight console docutils literal highlight-console"><span class="gp">HOST:~$ </span>groups<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>dialout</code>.
Si cela est le cas, vous pouvez ajouter l'utilisateur au groupe avec la commande</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>dialout<span class="w"> </span><span class="nv">$USER</span>
</pre></div>
</div>
<p>Ensuite il faudra fermer la session et la rouvrir, afin que les groupes soient
lus à nouveau par le système d'exploitation.</p>
<p>Picocom devrait vous retourner plusieurs lignes, pour terminer avec</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[    2.269306] Freeing unused kernel memory: 468K (c0823000 - c0898000)
[    2.338863] usb 1-1: new high-speed USB device number 2 using dwc2
[    2.483361] random: init urandom read with 13 bits of entropy available
[    2.548904] usb 1-1: New USB device found, idVendor=0424, idProduct=2512
[    2.555595] usb 1-1: New USB device strings: Mfr=0, Product=0, SerialNumber=0
[    2.563509] hub 1-1:1.0: USB hub found
[    2.567430] hub 1-1:1.0: 2 ports detected
[    2.689826] init: ureadahead main process (634) terminated with status 5
[    3.138233] random: nonblocking pool is initialized

Last login: Thu Jan  1 00:00:10 UTC 1970 on tty1
root@de1soclinux:~# uname -ar
Linux de1soclinux 3.18.0 #9 SMP Mon Aug 8 17:11:41 EDT 2016 armv7l armv7l armv7l GNU/Linux
root@de1soclinux:~#
</pre></div>
</div>
<p>Si vous ne voyez rien, tapez sur la touche <em>enter</em>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Veuillez noter que le noyau par défaut de la DE1-SoC n'est pas tout neuf... on remédiera bientôt à cela !</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Pour quitter Picocom, appuyez <strong>Ctrl+A</strong> suivi de <strong>Ctrl+X</strong>.</p>
</div>
</section>
<section id="configuration-des-serveurs-nfs-et-tftp">
<h3>Configuration des serveurs NFS et TFTP<a class="headerlink" href="#configuration-des-serveurs-nfs-et-tftp" title="Lien vers cette rubrique">#</a></h3>
<p>Ces deux services, sur la machine hôte, vont vous permettre d'échanger des fichiers entre la carte cible et la machine hôte.
En particulier, on utilisera TFTP pour &quot;envoyer&quot; à la DE1-SoC le noyau Linux (et le Device Tree), alors qu'on utilisera
NFS pour garder une partie du filesystem sur notre ordinateur.
Cela a un double avantage :</p>
<ul class="simple">
<li><p>On travaillera directement sur l'ordinateur, sans devoir à chaque fois échanger explicitement les fichiers entre la DE1-SoC et le PC (plus efficace).</p></li>
<li><p>On évitera d'écrire en continu sur la carte SD (donc on évitera de l'endommager pour rien).</p></li>
</ul>
<p>Il faut d'abord vérifier que ces deux services soient installés et actifs.
Si ce n'est pas le cas sur votre machine, installez les paquets
<strong>nfs-kernel-server</strong> et <strong>tftpd-hpa</strong>.</p>
<p>Il faut ensuite éditer le fichier <code class="file docutils literal notranslate"><span class="pre">/etc/exports</span></code> pour dire à NFS quels répertoires on veut partager
et avec qui :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/export        192.168.0.0/24(rw,no_subtree_check,sync,no_root_squash)
/export/drv    192.168.0.0/24(rw,no_subtree_check,sync,no_root_squash)
</pre></div>
</div>
<p>Bien sûr, maintenant il faudra créer le répertoire <code class="file docutils literal notranslate"><span class="pre">/export/drv</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/export/drv
<span class="gp">HOST:~$ </span>sudo<span class="w"> </span>chown<span class="w"> </span>reds:reds<span class="w"> </span>/export<span class="w"> </span>-R
</pre></div>
</div>
<p>Dans ce répertoire on pourra mettre des fichiers à partager avec la DE1-SoC.
Il faudra ensuite redémarrer NFS pour que la configuration soit relue.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>sudo<span class="w"> </span>service<span class="w"> </span>nfs-kernel-server<span class="w"> </span>restart
</pre></div>
</div>
<p>Maintenant, en regardant l'état du serveur NFS, vous devriez avoir
(<strong>le message pourrait changer selon la version du serveur!!</strong>) :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>service<span class="w"> </span>nfs-kernel-server<span class="w"> </span>status
<span class="go">* nfs-server.service - NFS server and services</span>
<span class="go">        Loaded: loaded (/lib/systemd/system/nfs-server.service; enabled; vendor preset: enabled)</span>
<span class="go">    Drop-In: /run/systemd/generator/nfs-server.service.d</span>
<span class="go">                └─order-with-mounts.conf</span>
<span class="go">        Active: active (exited) since Wed 2022-08-18 07:12:14 CEST; 1 day 3h ago</span>
<span class="go">    Process: 1021 ExecStartPre=/usr/sbin/exportfs -r (code=exited, status=0/SUCCESS)</span>
<span class="go">    Process: 1026 ExecStart=/usr/sbin/rpc.nfsd $RPCNFSDARGS (code=exited, status=0/SUCCESS)</span>
<span class="go">    Main PID: 1026 (code=exited, status=0/SUCCESS)</span>

<span class="go">Aug 18 07:12:13 rri-nb01 systemd[1]: Starting NFS server and services...</span>
<span class="go">Aug 18 07:12:14 rri-nb01 systemd[1]: Finished NFS server and services.</span>
</pre></div>
</div>
<p>Vous pouvez vérifier les répertoires partagés avec la commande</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>sudo<span class="w"> </span>showmount<span class="w"> </span>-e<span class="w"> </span>localhost
<span class="go">Export list for host:</span>
<span class="go">/export/drv 192.168.0.0/24</span>
<span class="go">/export     192.168.0.0/24</span>
</pre></div>
</div>
<p>Vérifions ensuite que le serveur TFTP soit actif (le message pourrait changer selon la version du
serveur) :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>/etc/init.d/tftpd-hpa<span class="w"> </span>status
<span class="go">* tftpd-hpa.service - LSB: HPA&#39;s tftp server</span>
<span class="go">  Loaded: loaded (/etc/init.d/tftpd-hpa; generated)</span>
<span class="go">  Active: active (running) since Thu 2022-08-19 11:36:18 CEST; 13min ago</span>
<span class="go">    Docs: man:systemd-sysv-generator(8)</span>
<span class="go"> Process: 2071 ExecStart=/etc/init.d/tftpd-hpa start (code=exited, status=0/SUCCESS)</span>
<span class="go">   Tasks: 1 (limit: 9485)</span>
<span class="go">  Memory: 1.2M</span>
<span class="go">  CGroup: /system.slice/tftpd-hpa.service</span>
<span class="go">          └─2095 /usr/sbin/in.tftpd --listen --user reds --address :69 -s /home/reds/tftpboot</span>

<span class="go">Aug 19 11:36:18 reds2022 systemd[1]: Starting LSB: HPA&#39;s tftp server...</span>
<span class="go">Aug 19 11:36:18 reds2022 tftpd-hpa[2071]:  * Starting HPA&#39;s tftpd in.tftpd</span>
<span class="go">Aug 19 11:36:18 reds2022 tftpd-hpa[2071]:    ...done.</span>
<span class="go">Aug 19 11:36:18 reds2022 systemd[1]: Started LSB: HPA&#39;s tftp server.</span>
</pre></div>
</div>
<p>Si l'on regarde son fichier de configuration <code class="file docutils literal notranslate"><span class="pre">/etc/default/tftpd-hpa</span></code>, on verra les lignes suivantes :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>cat<span class="w"> </span>/etc/default/tftpd-hpa
<span class="gp"># </span>/etc/default/tftpd-hpa

<span class="go">TFTP_USERNAME=&quot;reds&quot;</span>
<span class="go">TFTP_DIRECTORY=&quot;/home/reds/tftpboot&quot;</span>
<span class="go">TFTP_ADDRESS=&quot;:69&quot;</span>
<span class="go">TFTP_OPTIONS=&quot;-s&quot;</span>
</pre></div>
</div>
<p>On devra donc mettre dans <code class="file docutils literal notranslate"><span class="pre">/home/reds/tftpboot</span></code> l'image du noyau (<code class="file docutils literal notranslate"><span class="pre">zImage</span></code>) et
le fichier du Device Tree (<code class="file docutils literal notranslate"><span class="pre">socfpga.dtb</span></code>) contenus dans l'archive <code class="file docutils literal notranslate"><span class="pre">drv-2025-boot.tar.gz</span></code>.
Ensuite, donnez les droits de lecture à tout le monde à ces fichiers avec</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span><span class="nb">cd</span><span class="w"> </span>/home/reds/tftpboot
<span class="gp">HOST:~$ </span>chmod<span class="w"> </span><span class="m">777</span><span class="w"> </span>*
</pre></div>
</div>
</section>
<section id="configuration-reseau-de-la-machine-virtuelle">
<h3>Configuration réseau de la machine virtuelle<a class="headerlink" href="#configuration-reseau-de-la-machine-virtuelle" title="Lien vers cette rubrique">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Lisez cette section <strong>uniquement</strong> si vous travaillez avec la machine virtuelle !</p>
</div>
<p>Pour qu'il soit possible faire le boot et partager des répertoires à travers la machine virtuelle, il
faut que la configuration de la machine virtuelle soit adaptée.
En particulier, il faudra ajouter une deuxième carte réseau qui soit bridgée sur votre carte Ethernet
(celle que vous utilisez pour vous connecter à la DE1-SoC).
Le nom de votre carte pourrait changer, dans <strong>mon</strong> cas, il s'agissait de <strong>eth2</strong> (voir image ci-dessous).</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/virtualbox_net.png"><img alt="../_images/virtualbox_net.png" src="../_images/virtualbox_net.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Ajout de la carte réseau dans Virtualbox.</span><a class="headerlink" href="#id2" title="Lien vers cette image">#</a></p>
</figcaption>
</figure>
<p>Une fois cela fait (il faut que la machine virtuelle soit éteinte), vous devez la configurer afin
qu'elle ait l'adresse <em>192.168.0.1</em>, netmask <em>255.255.255.0</em>, ne mettez rien comme gateway (voir
figure ci-dessous). Redémarrez afin que les changements soient pris en compte (le NetworkManager d'Ubuntu
est souvent un peu têtu...). Si l'adresse n'est toujours pas la bonne, cliquez sur
la connexion correspondante dans le NetworkManager (cela devrait la recharger et tout devrait être bon).</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/network_device.png"><img alt="../_images/network_device.png" src="../_images/network_device.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Configuration de la carte réseau dans la VM Linux.</span><a class="headerlink" href="#id3" title="Lien vers cette image">#</a></p>
</figcaption>
</figure>
<p>Assurez-vous que la machine hôte n'ait pas l'adresse <em>192.168.0.1</em> pour la carte
que vous avez bridgé --- sinon il aura un conflit (vous pouvez changer cette
adresse, p.ex., en <em>192.168.0.11</em>).</p>
<p>De plus, vous devrez donner accès au port USB en cochant la case comme dans la figure qui suit.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/usb_conf.png"><img alt="../_images/usb_conf.png" src="../_images/usb_conf.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Configuration de la porte USB dans VirtualBox.</span><a class="headerlink" href="#id4" title="Lien vers cette image">#</a></p>
</figcaption>
</figure>
<p>Si vous ne voyez la porte en cliquant, c'est possible que l'utilisateur de la
machine hôte ne soit pas dans le groupe <em>vboxusers</em>. Vous pouvez l'ajouter avec :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>vboxusers<span class="w"> </span><span class="nv">$USER</span>
</pre></div>
</div>
<p>Il faut ensuite faire logout/login (dans la machine hôte) pour que cela soit pris en compte.</p>
</section>
<section id="parametrage-reseau-sur-la-machine-hote">
<h3>Paramétrage réseau sur la machine hôte<a class="headerlink" href="#parametrage-reseau-sur-la-machine-hote" title="Lien vers cette rubrique">#</a></h3>
<p>La connexion réseau s'effectue en reliant le port RJ45 de la DE1-SoC à celui de la machine hôte via
le câble réseau fourni. Cette connexion permettra de communiquer rapidement avec l'hôte via SSH ainsi
que d'utiliser un système de fichier NFS distant et de télécharger le noyau à travers TFTP.</p>
<p>Afin que la carte puisse bien se connecter à la machine hôte, il faut que
l'interface réseau à laquelle la DE1-SoC est connectée ait l'adresse 192.168.0.1.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Comme marqué dans la section VM ci-dessus, si vous utilisez la VM
alors cela s'applique uniquement à la VM, la machine hôte <strong>doit</strong>
avoir une autre adresse.</p>
</div>
<p>Les machines de laboratoire possèdent deux cartes LAN : une reliée au réseau de l'école, l'autre, secondaire, restant disponible
pour connecter un périphérique. Utilisez <code class="code highlight bash docutils literal highlight-bash">ifconfig</code> pour identifier laquelle est connectée à la DE1-SoC.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>ifconfig
<span class="go">p1p1   Link encap:Ethernet  HWaddr 00:02:b3:9a:01:ef</span>
<span class="go">       UP BROADCAST MULTICAST  MTU:1500  Metric:1</span>
<span class="go">       ...</span>
<span class="go">em1    Link encap:Ethernet  HWaddr 00:27:0e:28:c2:0d</span>
<span class="go">       inet addr:10.192.22.161  Bcast:10.192.22.255  Mask:255.255.248.0</span>
<span class="go">       ...</span>
</pre></div>
</div>
<p>Dans ce cas, <em>em1</em> est connectée au réseau LAN de l'école (réseau <em>10.192.22.255/21</em>), la carte secondaire est donc <em>p1p1</em>.
Par la suite, on configurera le bootloader de la DE1-SoC et le noyau Linux embarqué pour se connecter à l'adresse 192.168.0.1
en utilisant les protocoles NFS et TFTP lors du boot.
Si la carte secondaire n'est pas déjà initialisée à cette adresse une fois la DE1-SoC connectée,
activez manuellement <em>p1p1</em> et assignez-lui cette adresse.</p>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Si vous utilisez une distribution Ubuntu-derived (comme c'est le
cas pour la machine virtuelle et les machines de laboratoire),
changer les paramètres du réseau depuis la ligne de commande n'est pas forcément
une bonne idée, car l'outil <em>NetworkManager</em> veut avoir le contrôle absolu des cartes réseau.
<strong>Vous devrez donc changer ces paramètres à l'aide de l'outil visuel.</strong>
Si cela ne devait pas fonctionner, redémarrez l'outil avec la commande :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>sudo<span class="w"> </span>service<span class="w"> </span>NetworkManager<span class="w"> </span>restart
</pre></div>
</div>
</div>
</section>
<section id="configuration-et-utilisation-de-u-boot">
<h3>Configuration et utilisation de U-Boot<a class="headerlink" href="#configuration-et-utilisation-de-u-boot" title="Lien vers cette rubrique">#</a></h3>
<p>Dans cette section on verra comment configurer le système pour que le dispositif
de boot utilise TFTP et NFS pour récupérer le noyau et le filesystem depuis
l'ordinateur.</p>
<p>Au démarrage, vous pouvez appuyer sur une touche (via <code class="code docutils literal notranslate"><span class="pre">picocom</span></code>) pour arrêter le démarrage automatique
de U-Boot et jouer avec ses paramètres.
À l'écran vous devriez avoir un message du type :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>U-Boot<span class="w"> </span><span class="m">2013</span>.01.01<span class="w"> </span><span class="o">(</span>Apr<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">2014</span><span class="w"> </span>-<span class="w"> </span><span class="m">04</span>:59:35<span class="o">)</span>

CPU<span class="w">   </span>:<span class="w"> </span>Altera<span class="w"> </span>SOCFPGA<span class="w"> </span>Platform
BOARD<span class="w"> </span>:<span class="w"> </span>Altera<span class="w"> </span>SOCFPGA<span class="w"> </span>Cyclone<span class="w"> </span>V<span class="w"> </span>Board
I2C:<span class="w">   </span>ready
DRAM:<span class="w">  </span><span class="m">1</span><span class="w"> </span>GiB
MMC:<span class="w">   </span>ALTERA<span class="w"> </span>DWMMC:<span class="w"> </span><span class="m">0</span>
In:<span class="w">    </span>serial
Out:<span class="w">   </span>serial
Err:<span class="w">   </span>serial
Net:<span class="w">   </span>mii0
Hit<span class="w"> </span>any<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span>stop<span class="w"> </span>autoboot:<span class="w">  </span><span class="m">0</span>
Configuring<span class="w"> </span>PHY<span class="w"> </span>skew<span class="w"> </span>timing<span class="w"> </span><span class="k">for</span><span class="w"> </span>Micrel<span class="w"> </span>ksz9021
Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>PHY<span class="w"> </span>auto<span class="w"> </span>negotiation<span class="w"> </span>to<span class="w"> </span>complete..<span class="w"> </span><span class="k">done</span>
ENET<span class="w"> </span>Speed<span class="w"> </span>is<span class="w"> </span><span class="m">1000</span><span class="w"> </span>Mbps<span class="w"> </span>-<span class="w"> </span>FULL<span class="w"> </span>duplex<span class="w"> </span>connection
Using<span class="w"> </span>mii0<span class="w"> </span>device
TFTP<span class="w"> </span>from<span class="w"> </span>server<span class="w"> </span><span class="m">192</span>.168.0.1<span class="p">;</span><span class="w"> </span>our<span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span>is<span class="w"> </span><span class="m">192</span>.168.0.2
Filename<span class="w"> </span><span class="s1">&#39;uImage&#39;</span>.
Load<span class="w"> </span>address:<span class="w"> </span>0x7fc0
Loading:<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T<span class="w"> </span>T
Retry<span class="w"> </span>count<span class="w"> </span>exceeded<span class="p">;</span><span class="w"> </span>starting<span class="w"> </span>again
Using<span class="w"> </span>mii0<span class="w"> </span>device
TFTP<span class="w"> </span>from<span class="w"> </span>server<span class="w"> </span><span class="m">192</span>.168.0.1<span class="p">;</span><span class="w"> </span>our<span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span>is<span class="w"> </span><span class="m">192</span>.168.0.2
Filename<span class="w"> </span><span class="s1">&#39;uImage&#39;</span>.
Load<span class="w"> </span>address:<span class="w"> </span>0x7fc0
Loading:<span class="w"> </span>T<span class="w"> </span>T
U-Boot<span class="w"> </span>SPL<span class="w"> </span><span class="m">2013</span>.01.01<span class="w"> </span><span class="o">(</span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">2015</span><span class="w"> </span>-<span class="w"> </span><span class="m">14</span>:28:04<span class="o">)</span>
BOARD<span class="w"> </span>:<span class="w"> </span>Terasic<span class="w"> </span>DE1_SoC<span class="w"> </span>Board
<span class="c1">################################################################################</span>
<span class="c1">##################################=                                           =#</span>
<span class="c1">########=-=#######################=                                     --    =#</span>
<span class="c1">######-   =#######################=                        ####-    =######   =#</span>
<span class="c1">######-   ###############- -=##=##=                        ####-   ########   =#</span>
<span class="c1">####=       =##-     -###       ##=   -#######    ######   ####-  #####-  -   =#</span>
<span class="c1">####        ##   ###   ##      -##=   -=--=###=  ####==#   ####-  ####        =#</span>
<span class="c1">######-   ###-  ##-  -###    =####=   =====###=  ####-     ####   ####        =#</span>
<span class="c1">######-   ###      =#####    #####=  ####-=###=    -=###-  ####-  #####       =#</span>
<span class="c1">######-    -#=     -  =##    #####=  #### -###=  #=-=####  ####-   ########-  ##</span>
<span class="c1">#######    =##=        ##    #####=  -########=  #######   ####-    =######   =#</span>
<span class="c1">#########==######====####==#######=     -         ---      --          ----   =#</span>
<span class="c1">##################################=                                           =#</span>
<span class="c1">################################################################################</span>
BOARD<span class="w"> </span>:<span class="w"> </span>Terasic<span class="w">  </span>DE1_SoC<span class="w"> </span>Board
CLOCK:<span class="w"> </span>EOSC1<span class="w"> </span>clock<span class="w"> </span><span class="m">25000</span><span class="w"> </span>KHz
CLOCK:<span class="w"> </span>EOSC2<span class="w"> </span>clock<span class="w"> </span><span class="m">25000</span><span class="w"> </span>KHz
CLOCK:<span class="w"> </span>F2S_SDR_REF<span class="w"> </span>clock<span class="w"> </span><span class="m">0</span><span class="w"> </span>KHz
CLOCK:<span class="w"> </span>F2S_PER_REF<span class="w"> </span>clock<span class="w"> </span><span class="m">0</span><span class="w"> </span>KHz
CLOCK:<span class="w"> </span>MPU<span class="w"> </span>clock<span class="w"> </span><span class="m">800</span><span class="w"> </span>MHz
CLOCK:<span class="w"> </span>DDR<span class="w"> </span>clock<span class="w"> </span><span class="m">400</span><span class="w"> </span>MHz
CLOCK:<span class="w"> </span>UART<span class="w"> </span>clock<span class="w"> </span><span class="m">100000</span><span class="w"> </span>KHz
CLOCK:<span class="w"> </span>MMC<span class="w"> </span>clock<span class="w"> </span><span class="m">50000</span><span class="w"> </span>KHz
CLOCK:<span class="w"> </span>QSPI<span class="w"> </span>clock<span class="w"> </span><span class="m">400000</span><span class="w"> </span>KHz
INFO<span class="w"> </span>:<span class="w"> </span>Watchdog<span class="w"> </span>enabled
SDRAM:<span class="w"> </span>Initializing<span class="w"> </span>MMR<span class="w"> </span>registers
SDRAM:<span class="w"> </span>Calibrating<span class="w"> </span>PHY
SEQ.C:<span class="w"> </span>Preparing<span class="w"> </span>to<span class="w"> </span>start<span class="w"> </span>memory<span class="w"> </span>calibration
SEQ.C:<span class="w"> </span>CALIBRATION<span class="w"> </span>PASSED
SDRAM:<span class="w"> </span><span class="m">1024</span><span class="w"> </span>MiB
ALTERA<span class="w"> </span>DWMMC:<span class="w"> </span><span class="m">0</span>


U-Boot<span class="w"> </span><span class="m">2013</span>.01.01<span class="w"> </span><span class="o">(</span>Apr<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">2014</span><span class="w"> </span>-<span class="w"> </span><span class="m">04</span>:59:35<span class="o">)</span>

CPU<span class="w">   </span>:<span class="w"> </span>Altera<span class="w"> </span>SOCFPGA<span class="w"> </span>Platform
BOARD<span class="w"> </span>:<span class="w"> </span>Altera<span class="w"> </span>SOCFPGA<span class="w"> </span>Cyclone<span class="w"> </span>V<span class="w"> </span>Board
I2C:<span class="w">   </span>ready
DRAM:<span class="w">  </span><span class="m">1</span><span class="w"> </span>GiB
MMC:<span class="w">   </span>ALTERA<span class="w"> </span>DWMMC:<span class="w"> </span><span class="m">0</span>
In:<span class="w">    </span>serial
Out:<span class="w">   </span>serial
Err:<span class="w">   </span>serial
Net:<span class="w">   </span>mii0
Hit<span class="w"> </span>any<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span>stop<span class="w"> </span>autoboot:
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Si vous l'avez raté, redémarrez simplement la carte avec la commande <code class="code highlight console docutils literal highlight-console"><span class="gp">root@de1soclinux:~# </span>reboot</code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Pour le redémarrage, il y a un bouton <em>WARM_RST</em> sur la carte (à droite des gros boutons KEY 3-0), veuillez l'utiliser à la place
du bouton <em>POWER ON/OFF</em>, votre carte sera bien plus heureuse !</p>
</div>
<p>Vous pouvez afficher la valeur actuelle des paramètres passés à U-Boot à l'aide de la commande :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">SOCFPGA_CYCLONE5:~# </span>printenv
</pre></div>
</div>
<p>U-Boot est un programme relativement complexe, mettant à la disposition de
l'utilisateur une console interactive avec support des variables d'environnement
et un jeu de commandes élaboré.
De plus, U-Boot fournit un support matériel basique pour certains périphériques,
comme les cartes réseau LAN et les périphériques flash, les cartes SD ou
la flash embarquée.
La commande <code class="code highlight bash docutils literal highlight-bash"><span class="nb">help</span></code> permet de visualiser les commandes disponibles.
Pour un manuel complet, se référer à <a class="reference external" href="https://docs.u-boot.org/en/latest/">la documentation officielle</a>.</p>
<p>En donnant la commande <code class="code highlight bash docutils literal highlight-bash">boot</code>, le système va continuer la procédure de démarrage
établie par défaut.</p>
<p>Vous pouvez le modifier pour qu'il fasse booter la carte depuis le noyau Linux
stocké sur votre PC (dans le répertoire <code class="file docutils literal notranslate"><span class="pre">/home/reds/tftpboot</span></code>)
en ajoutant les lignes qui suivent au prompt de U-Boot.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>ethaddr<span class="w"> </span><span class="s2">&quot;12:34:56:78:90:12&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>serverip<span class="w"> </span><span class="s2">&quot;192.168.0.1&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>ipaddr<span class="w"> </span><span class="s2">&quot;192.168.0.2&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>gatewayip<span class="w"> </span><span class="s2">&quot;192.168.0.1&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>bootdelay<span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>loadaddr<span class="w"> </span><span class="s2">&quot;0xF000&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>bootcmd<span class="w"> </span><span class="s2">&quot;mmc rescan; tftpboot </span><span class="si">${</span><span class="nv">loadaddr</span><span class="si">}</span><span class="s2"> zImage; tftpboot </span><span class="si">${</span><span class="nv">fdtaddr</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">fdtimage</span><span class="si">}</span><span class="s2">; run fpgaload; run bridge_enable_handoff; run mmcboot&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>setenv<span class="w"> </span>mmcboot<span class="w"> </span><span class="s2">&quot;setenv bootargs console=ttyS0,115200 root=</span><span class="si">${</span><span class="nv">mmcroot</span><span class="si">}</span><span class="s2"> rw rootwait ip=</span><span class="si">${</span><span class="nv">ipaddr</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">serverip</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">serverip</span><span class="si">}</span><span class="s2">:255.255.255.0:de1soclinux:eth0:on; bootz </span><span class="si">${</span><span class="nv">loadaddr</span><span class="si">}</span><span class="s2"> - </span><span class="si">${</span><span class="nv">fdtaddr</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>saveenv
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pourriez-vous expliquer les lignes ci-dessus ?</p>
<p>Le noyau Linux accepte une longue liste de paramètres, vous pouvez avoir
plus d'informations en lisant le fichier <code class="file docutils literal notranslate"><span class="pre">Documentation/admin-guide/kernel-parameters.txt</span></code>
dans les sources du noyau.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Est-ce que <code class="code highlight bash docutils literal highlight-bash"><span class="si">${</span><span class="nv">loadaddr</span><span class="si">}</span><span class="w"> </span>-<span class="w"> </span><span class="si">${</span><span class="nv">fdtaddr</span><span class="si">}</span></code> est une soustraction de deux adresses dans la mémoire ?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>La configuration de U-Boot sauvegardée dans la mémoire de la carte est
assez complexe. Explorez les différentes valeurs et essayez
d'effectuer le boot de la carte en changeant (de façon temporaire!! --- c.-à-d., sans utiliser la commande <em>saveenv</em>)
l'adresse du PC, le répertoire où le noyau est stocké, ...</p>
</div>
<p>Maintenant, en démarrant la DE1-SoC, vous devriez pouvoir faire le boot du système en utilisant le
noyau qui vous a été fourni (celui dans <code class="file docutils literal notranslate"><span class="pre">/home/reds/tftpboot</span></code>). Vous devriez donc avoir un
output qui se termine par</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="w">    </span><span class="m">6</span>.121032<span class="o">]</span><span class="w"> </span>IP-Config:<span class="w"> </span>Complete:
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.124256<span class="o">]</span><span class="w">      </span><span class="nv">device</span><span class="o">=</span>eth0,<span class="w"> </span><span class="nv">hwaddr</span><span class="o">=</span><span class="m">12</span>:34:56:78:90:12,<span class="w"> </span><span class="nv">ipaddr</span><span class="o">=</span><span class="m">192</span>.168.0.123,<span class="w"> </span><span class="nv">mask</span><span class="o">=</span><span class="m">255</span>.255.255.0,<span class="w"> </span><span class="nv">gw</span><span class="o">=</span><span class="m">192</span>.168.0.1
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.134418<span class="o">]</span><span class="w">      </span><span class="nv">host</span><span class="o">=</span>de1soclinux,<span class="w"> </span><span class="nv">domain</span><span class="o">=</span>,<span class="w"> </span>nis-domain<span class="o">=(</span>none<span class="o">)</span>
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.140145<span class="o">]</span><span class="w">      </span><span class="nv">bootserver</span><span class="o">=</span><span class="m">192</span>.168.0.1,<span class="w"> </span><span class="nv">rootserver</span><span class="o">=</span><span class="m">192</span>.168.0.1,<span class="w"> </span><span class="nv">rootpath</span><span class="o">=</span>
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.140630<span class="o">]</span><span class="w"> </span>dw-apb-uart<span class="w"> </span>ffc02000.serial0:<span class="w"> </span>forbid<span class="w"> </span>DMA<span class="w"> </span><span class="k">for</span><span class="w"> </span>kernel<span class="w"> </span>console
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.169671<span class="o">]</span><span class="w"> </span>EXT4-fs<span class="w"> </span><span class="o">(</span>mmcblk0p2<span class="o">)</span>:<span class="w"> </span>mounted<span class="w"> </span>filesystem<span class="w"> </span>with<span class="w"> </span>ordered<span class="w"> </span>data<span class="w"> </span>mode.<span class="w"> </span>Quota<span class="w"> </span>mode:<span class="w"> </span>disabled.
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.178615<span class="o">]</span><span class="w"> </span>VFS:<span class="w"> </span>Mounted<span class="w"> </span>root<span class="w"> </span><span class="o">(</span>ext4<span class="w"> </span>filesystem<span class="o">)</span><span class="w"> </span>on<span class="w"> </span>device<span class="w"> </span><span class="m">179</span>:2.
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.195165<span class="o">]</span><span class="w"> </span>devtmpfs:<span class="w"> </span>mounted
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.200981<span class="o">]</span><span class="w"> </span>Freeing<span class="w"> </span>unused<span class="w"> </span>kernel<span class="w"> </span>image<span class="w"> </span><span class="o">(</span>initmem<span class="o">)</span><span class="w"> </span>memory:<span class="w"> </span>1024K
<span class="o">[</span><span class="w">    </span><span class="m">6</span>.207310<span class="o">]</span><span class="w"> </span>Run<span class="w"> </span>/sbin/init<span class="w"> </span>as<span class="w"> </span>init<span class="w"> </span>process
<span class="o">[</span><span class="w">    </span><span class="m">9</span>.001028<span class="o">]</span><span class="w"> </span>random:<span class="w"> </span>crng<span class="w"> </span>init<span class="w"> </span><span class="k">done</span>
<span class="o">[</span><span class="w">    </span><span class="m">9</span>.170095<span class="o">]</span><span class="w"> </span>init:<span class="w"> </span>hwclock<span class="w"> </span>main<span class="w"> </span>process<span class="w"> </span><span class="o">(</span><span class="m">54</span><span class="o">)</span><span class="w"> </span>terminated<span class="w"> </span>with<span class="w"> </span>status<span class="w"> </span><span class="m">1</span>
<span class="o">[</span><span class="w">    </span><span class="m">9</span>.184453<span class="o">]</span><span class="w"> </span>init:<span class="w"> </span>ureadahead<span class="w"> </span>main<span class="w"> </span>process<span class="w"> </span><span class="o">(</span><span class="m">55</span><span class="o">)</span><span class="w"> </span>terminated<span class="w"> </span>with<span class="w"> </span>status<span class="w"> </span><span class="m">5</span>

Last<span class="w"> </span>login:<span class="w"> </span>Thu<span class="w"> </span>Jan<span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">00</span>:00:16<span class="w"> </span>UTC<span class="w"> </span><span class="m">1970</span><span class="w"> </span>on<span class="w"> </span>tty1
root@de1soclinux:~#<span class="w"> </span>uname<span class="w"> </span>-ar
Linux<span class="w"> </span>de1soclinux<span class="w"> </span><span class="m">6</span>.1.55+<span class="w"> </span><span class="c1">#4 SMP Wed Feb 21 11:30:34 CET 2024 armv7l armv7l armv7l GNU/Linux</span>
root@de1soclinux:~#
</pre></div>
</div>
</section>
<section id="verification-des-toolchains">
<h3>Vérification des toolchains<a class="headerlink" href="#verification-des-toolchains" title="Lien vers cette rubrique">#</a></h3>
<p>Pendant les laboratoires, la toolchain <strong>arm-linux-gnueabifh</strong> (version <em>6.4.1</em>)
sera utilisée pour la compilation d'exécutables Linux.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pourriez-vous expliquer la signification des différents mots composant le nom de la toolchain?
Pourquoi on a spécifié un numéro de version ?
Qu'est-ce qui se passe si l'on prend tout simplement la toute dernière version de la toolchain?</p>
</div>
<p>Vérifiez la version de la toolchain par défaut :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>arm-linux-gnueabihf-gcc<span class="w"> </span>--version
</pre></div>
</div>
<p>S'il s'agit d'une version différente, vérifiez que la version <em>6.4.1</em> existe bien :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>arm-linux-gnueabihf-gcc-6.4.1<span class="w"> </span>--version
</pre></div>
</div>
<p>Auquel cas, ajouter <code class="code highlight bash docutils literal highlight-bash">-6.4.1</code> lors des appels suivants à <code class="code highlight bash docutils literal highlight-bash">arm-linux-gnueabihf-gcc</code>.
Pour utiliser les autres outils fournis avec le compilateur (comme <code class="code highlight bash docutils literal highlight-bash">objdump</code>), il faut mettre le chemin complet vers les exécutables qui se trouvent dans le dossier <code class="file docutils literal notranslate"><span class="pre">/opt/toolchains/arm-linux-gnueabihf_6.4.1/bin/</span></code> sur la VM.</p>
<p>Finalement, vérifiez que la toolchain fonctionne correctement.
Pour cela vous pouvez utiliser la commande suivante:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;int main(){}&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>arm-linux-gnueabihf-gcc<span class="w"> </span>-x<span class="w"> </span>c<span class="w"> </span>-<span class="w"> </span>-o<span class="w"> </span>/dev/stdout<span class="w"> </span><span class="p">|</span><span class="w"> </span>file<span class="w"> </span>-
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pourriez-vous expliquer ce que la ligne ci-dessus fait?</p>
</div>
<p>Si tout marche bien, vous devriez avoir une réponse du type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/dev/stdin:<span class="w"> </span>ELF<span class="w"> </span><span class="m">32</span>-bit<span class="w"> </span>LSB<span class="w"> </span>executable,<span class="w"> </span>ARM,<span class="w"> </span>EABI5<span class="w"> </span>version<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>SYSV<span class="o">)</span>,<span class="w"> </span>dynamically<span class="w"> </span>linked,<span class="w"> </span>interpreter<span class="w"> </span>/lib/ld-linux-armhf.so.3,<span class="w"> </span><span class="k">for</span><span class="w"> </span>GNU/Linux<span class="w"> </span><span class="m">2</span>.6.32,<span class="w"> </span>BuildID<span class="o">[</span>sha1<span class="o">]=</span>b7a0db97fce5c152f9ae99800a40817aba3cfa1d,<span class="w"> </span>with<span class="w"> </span>debug_info,<span class="w"> </span>not<span class="w"> </span>stripped<span class="w"> </span>debug_info,<span class="w"> </span>not<span class="w"> </span>stripped
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Savez-vous interpréter ces réponses ?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Que signifie <em>&quot;not stripped&quot;</em> ?</p>
</div>
</section>
<section id="compilation-sur-la-cible-native">
<h3>Compilation sur la cible (native)<a class="headerlink" href="#compilation-sur-la-cible-native" title="Lien vers cette rubrique">#</a></h3>
<p>Vos applications peuvent <strong>parfois</strong> être compilées directement sur la cible embarquée avec les mêmes commandes que vous
utilisez sur votre PC de développement --- pourvu que le compilateur et les
bibliothèques nécessaires soient installées et que le
processeur soit assez puissant, sinon vous allez attendre des siècles...
Avec votre éditeur préféré (soit avec <strong>emacs</strong> ou <strong>vim</strong> dans le terminal directement sur la cible), créez un
fichier <code class="file docutils literal notranslate"><span class="pre">hello_native.c</span></code> avec le contenu qui suit :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello REDS!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ensuite, compilez-le avec la commande</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">root@de1soclinux:~# </span>gcc<span class="w"> </span>hello_native.c<span class="w"> </span>-o<span class="w"> </span>hello_native
</pre></div>
</div>
<p>et testez-le avec</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">root@de1soclinux:~# </span>./hello_native
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quelle version de GCC est installée sur la carte ?</p>
</div>
</section>
<section id="compilation-croisee-sous-de1-soc">
<h3>Compilation croisée sous DE1-SoC<a class="headerlink" href="#compilation-croisee-sous-de1-soc" title="Lien vers cette rubrique">#</a></h3>
<p>La compilation croisée standard nécessite quelques précautions supplémentaires
par rapport à une compilation native :</p>
<ul class="simple">
<li><p>La toolchain doit être compatible et paramétrée pour la cible choisie.
Pour garantir une compatibilité entre le code généré par la toolchain et le
système auquel il est destiné, il faut dans tous les cas que le compilateur
utilisé pour compiler l'OS présent sur la cible et celui utilisé pour compiler
l'application aient la même interface binaire (ABI).</p></li>
<li><p>Le chemin des bibliothèques et des includes spécifiques à la carte cible
doivent être précisés. Les bibliothèques présentes dans la machine hôte ayant
été compilées pour une architecture différente, elles ne sont pas exécutables
sur la carte cible.</p></li>
<li><p>Les versions des bibliothèques et includes utilisés doivent être celles du
système cible.
Dans le cas de la compilation d'un driver Linux, les sources du noyau doivent
être disponibles et leur version doit également correspondre.</p></li>
</ul>
<p>Pour répondre au premier point de la problématique précédente, nous utilisons
ici la même toolchain qui a été utilisée pour générer la distribution Linux
cible, c'est-à-dire <strong>arm-linux-gnueabihf</strong> --- <strong>gnueabihf</strong> étant une ABI
normalisée pour les systèmes ARM possédant une unité de calcul hardware pour les
flottants (&quot;hard float&quot;) --- et avec un numéro de version très proche.</p>
<p>Il est simple de cross-compiler notre première application, un &quot;Hello world&quot; classique.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello, cross-compiled world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Le fichier <code class="file docutils literal notranslate"><span class="pre">stdio.h</span></code> inclus dans le code est celui de la libc spécifique à
la toolchain installée. Pas besoin, pour les headers appartenant à des
bibliothèques fournies avec la toolchain (<em>libc</em>, <em>libm</em>, <em>libcrypt</em>,
<em>libpthread</em> et quelques autres) de préciser un dossier d'inclusion spécifique.
L'invocation du compilateur s'effectue donc de la même manière que l'invocation
d'un compilateur natif :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>arm-linux-gnueabihf-gcc<span class="w"> </span>hello.c<span class="w"> </span>-o<span class="w"> </span>hello
<span class="gp">HOST:~$ </span>ls<span class="w"> </span>-al<span class="w"> </span>hello
<span class="go">-rwxrwxr-x 1 rob rob 10228 Sep  1 14:56 hello</span>
<span class="gp">HOST:~$ </span>file<span class="w"> </span>hello
<span class="go">hello: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-armhf.so.3, for GNU/Linux 2.6.32, BuildID[sha1]=e295f4dc983156976c528d29073f98cade530ec8, with debug_info, not stripped</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Qu'est-ce qui se passerait si vous essayiez d'exécuter ce fichier sur votre PC ? Pourquoi ?</p>
</div>
<p>Le fichier résultant est un exécutable linké dynamiquement.
Il est également possible de procéder à une compilation statique, si les
bibliothèques utilisées ne sont pas disponibles sur la cible (ce qui n'est
évidemment pas le cas ici, vu que seule la <em>libc</em> est utilisée).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">HOST:~$ </span>arm-linux-gnueabihf-gcc<span class="w"> </span>hello.c<span class="w"> </span>-o<span class="w"> </span>hello_static<span class="w"> </span>-static
<span class="gp">HOST:~$ </span>ls<span class="w"> </span>-al<span class="w"> </span>hello_static
<span class="go">-rwxrwxr-x 1 rob rob 3972176 Sep  1 14:57 hello_static</span>
<span class="gp">HOST:~$ </span>file<span class="w"> </span>hello_static
<span class="go">hello_static: ELF 32-bit LSB executable, ARM, EABI5 version 1 (GNU/Linux), statically linked, for GNU/Linux 2.6.32, BuildID[sha1]=d2b9e57feaa2d0c24525a548f0cfdb7bf3d2f45a, with debug_info, not stripped</span>
</pre></div>
</div>
<p>Comme la taille de l'exécutable s'en retrouve dramatiquement accrue, la
compilation statique est réservée aux cas spéciaux.</p>
<p>Pour tester, mettez l'exécutable dans le dossier <code class="file docutils literal notranslate"><span class="pre">/export/drv/</span></code> de la machine hôte et depuis la cible exécutez :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">root@de1soclinux:~# </span>~/drv/hello
</pre></div>
</div>
<p>Si l'erreur suivante apparaît, la mauvaise toolchain a été utilisée lors de la compilation, assurez-vous de bien utiliser la version <em>6.4.1</em>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>~/drv/hello:<span class="w"> </span>/lib/arm-linux-gnueabihf/libc.so.6:<span class="w"> </span>version<span class="w"> </span><span class="s1">&#39;GLIBC_2.34&#39;</span><span class="w"> </span>not<span class="w"> </span>found<span class="w"> </span><span class="o">(</span>required<span class="w"> </span>by<span class="w"> </span>~/drv/hello<span class="o">)</span>
</pre></div>
</div>
</section>
</section>
<section id="acces-aux-peripheriques-du-cyclonev-soc-depuis-u-boot">
<h2>Accès aux périphériques du CycloneV-SoC depuis U-Boot<a class="headerlink" href="#acces-aux-peripheriques-du-cyclonev-soc-depuis-u-boot" title="Lien vers cette rubrique">#</a></h2>
<p>La plupart des périphériques du CycloneV-SoC ne sont pas accessibles au core ARM
qu'à travers la FPGA:</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/schema_de1soc.png"><img alt="../_images/schema_de1soc.png" src="../_images/schema_de1soc.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Diagramme du DE1-SoC computer (Figure 1 dans <em>&quot;DE1-SoC Computer System with ARM Cortex-A9&quot;</em>).</span><a class="headerlink" href="#id5" title="Lien vers cette image">#</a></p>
</figcaption>
</figure>
<p>En particulier, grâce au bitstream chargé au démarrage, les différents
périphériques sont accessibles en <em>memory-map</em> en utilisant des accès mémoire.</p>
<p>La liste des adresses mémoire est disponible dans le chapitre 7 du document
<em>&quot;DE1-SoC Computer System with ARM Cortex-A9&quot;</em> (page 29).
La section 2.9 (page 7) de ce même document donne plus d'information sur les registres
des périphériques qui seront utilisés (LEDs, switchs, ...).</p>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Avant d'essayer les commandes ci-dessous, assurez-vous que le bon bitstream soit
chargé en faisant un boot complète du système.
A ce moment-là, dès que vous aurez le prompt Linux, tapez une commande</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">root@de1soclinux:~# </span>reboot
</pre></div>
</div>
<p>et arrêtez le système au prompt U-Boot au redémarrage.</p>
</div>
<p>U-Boot possède un ensemble de commandes dédiées à la manipulation de données :</p>
<ul>
<li><p>la commande <em>memory display</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>md.<span class="o">{</span>b<span class="p">|</span>w<span class="p">|</span>l<span class="o">}</span><span class="w"> </span>addr<span class="w"> </span>length
</pre></div>
</div>
<p>permet d'afficher
<code class="code highlight bash docutils literal highlight-bash">length</code> données depuis l'adresse <code class="code highlight bash docutils literal highlight-bash">addr</code>, sous un certain format :</p>
<ul class="simple">
<li><p><code class="code highlight bash docutils literal highlight-bash">md.b</code> affichant les données sous forme de mots de 8 bits</p></li>
<li><p><code class="code highlight bash docutils literal highlight-bash">md.w</code> affichant les données sous forme de mots de 16 bits</p></li>
<li><p><code class="code highlight bash docutils literal highlight-bash">md.l</code> affichant les données sous forme de mots de 32 bits</p></li>
</ul>
<p>Notez que si vous affichez 8 ou 16 bits d'un registre 32 bits,
<strong>vous allez récupérer les bytes de poids faible</strong>,
et non pas ceux de poids fort.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Est-ce que cela nous dit quelque chose sur l'endianness du MCU?</p>
</div>
</li>
<li><p>la commande associée <em>memory write</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mw.<span class="o">{</span>b<span class="p">|</span>w<span class="p">|</span>l<span class="o">}</span><span class="w"> </span>addr<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>n<span class="o">)</span>
</pre></div>
</div>
<p>permet de
modifier la valeur de <code class="code highlight bash docutils literal highlight-bash">n</code> données à partir de <code class="code highlight bash docutils literal highlight-bash">addr</code>, avec une
taille d'élément de donnée de 1, 2 ou 4 bytes.</p>
</li>
</ul>
<section id="exemple">
<h3>Exemple<a class="headerlink" href="#exemple" title="Lien vers cette rubrique">#</a></h3>
<p>Les commandes ci-dessous affichent le contenu de la mémoire à l'adresse de
chargement de U-Boot sous chacun des trois formats disponibles.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">SOCFPGA_CYCLONE5:~# </span>md.b<span class="w"> </span>0x80008000<span class="w"> </span>0x1
<span class="go">80008000: 46    F</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>md.w<span class="w"> </span>0x80008000<span class="w"> </span>0x1
<span class="go">80008000: 4c46    FL</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>md.l<span class="w"> </span>0x80008000<span class="w"> </span>0x1
<span class="go">80008000: eb004c46    FL..</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>md.b<span class="w"> </span>0x80008000<span class="w"> </span>0x4
<span class="go">80008000: 46 4c 00 eb    FL..</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>md.w<span class="w"> </span>0x80008000<span class="w"> </span>0x4
<span class="go">80008000: 4c46 eb00 9000 e10f    FL......</span>
<span class="gp">SOCFPGA_CYCLONE5:~# </span>md.l<span class="w"> </span>0x80008000<span class="w"> </span>0x4
<span class="go">80008000: eb004c46 e10f9000 e229901a e319001f    FL........).....</span>
</pre></div>
</div>
<div class="admonition-exercice-1 admonition">
<p class="admonition-title"><strong>Exercice 1</strong></p>
<ul class="simple">
<li><p>Expliquez les différences entre les lignes ci-dessus.</p></li>
<li><p>Utilisez la commande <code class="code highlight bash docutils literal highlight-bash">md</code> pour lire la valeur binaire écrite avec les
switches et écrivez-la sur les LEDs.</p></li>
<li><p>Qu'est-ce qui se passe si vous essayez d'accéder à une adresse qui n'est pas alignée (par exemple <em>0x01010101</em>) et pourquoi ?</p></li>
</ul>
</div>
<div class="admonition-exercice-2 admonition">
<p class="admonition-title"><strong>Exercice 2</strong></p>
<p>Écrivez un script (à l'aide d'une variable d'environnement) U-Boot qui va alterner, chaque seconde, entre afficher 🯰🯰🯰🯰🯰🯰 et 🯵🯵🯵🯵🯵🯵 sur les affichages à 7-segments.</p>
<p>Vous trouverez plus d'information sur le shell d'U-Boot via les liens suivants :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://docs.u-boot.org/en/latest/usage/cmdline.html">https://docs.u-boot.org/en/latest/usage/cmdline.html</a></p></li>
<li><p><a class="reference external" href="https://mediawiki.compulab.com/w/index.php?title=U-Boot%3A_Quick_reference">https://mediawiki.compulab.com/w/index.php?title=U-Boot%3A_Quick_reference</a></p></li>
</ul>
</div></blockquote>
</div>
</section>
</section>
<section id="acces-aux-peripheriques-du-de1-soc-depuis-linux">
<h2>Accès aux périphériques du DE1-SoC depuis Linux<a class="headerlink" href="#acces-aux-peripheriques-du-de1-soc-depuis-linux" title="Lien vers cette rubrique">#</a></h2>
<p>Le même type d'accès aux ressources vu dans la section précédente est possible
depuis Linux.
En particulier, il est possible d'ouvrir un fichier spécial (<code class="file docutils literal notranslate"><span class="pre">/dev/mem</span></code>)
et, après l'avoir mappé en mémoire avec la fonction <code class="code highlight c docutils literal highlight-c"><span class="n">mmap</span><span class="p">()</span></code>, taper des
valeurs directement dans la mémoire.</p>
<p>Pour plus d'information sur <code class="code highlight c docutils literal highlight-c"><span class="n">mmap</span></code>, regardez dans sa documentation <a class="reference external" href="https://www.man7.org/linux/man-pages/man2/mmap.2.html">man</a>
ainsi que cet <a class="reference external" href="https://bakhi.github.io/devmem/">exemple</a>.
Attention cette exemple utilise <code class="code highlight c docutils literal highlight-c"><span class="n">PAGE_SIZE</span></code> comme adresse qui est défini à la compilation, or tous les systèmes n'ont pas la même taille de page. Regardez dans la description <code class="code highlight c docutils literal highlight-c"><span class="n">man</span></code> de <code class="code highlight c docutils literal highlight-c"><span class="n">mmap</span></code> pour trouver une alternative !</p>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>En faisant ça, vous avez accès direct à <strong>toute</strong> la mémoire...
Sans aucune supervision ni limitation !</p>
</div>
<p>Cette approche est très utile pour tester rapidement un dispositif --- vous pouvez
en effet accéder à ses registres et lire/écrire des valeurs, sans devoir écrire
un driver.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pouvez-vous identifier au moins deux gros problèmes de cette approche ?</p>
</div>
<div class="admonition-exercice-3 admonition">
<p class="admonition-title"><strong>Exercice 3</strong></p>
<p>Écrivez un logiciel user-space en C qui utilise <code class="file docutils literal notranslate"><span class="pre">/dev/mem</span></code> pour accéder aux périphériques.
Au démarrage, le logiciel commence par afficher <code class="docutils literal notranslate"><span class="pre">A</span></code> sur l’affichage HEX0.
Ensuite, l’utilisateur peut contrôler la lettre affichée sur HEX0 de la façon suivante:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>En appuyant sur KEY0, le caractère actuellement affiché est décrémenté</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Z</span></code> devient <code class="docutils literal notranslate"><span class="pre">Y</span></code>, ... , <code class="docutils literal notranslate"><span class="pre">B</span></code> devient <code class="docutils literal notranslate"><span class="pre">A</span></code></p></li>
<li><p>Si <code class="docutils literal notranslate"><span class="pre">A</span></code> est affiché, on recommence à <code class="docutils literal notranslate"><span class="pre">Z</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>En appuyant sur KEY1, le caractère actuellement affiché est incrémenté</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> devient <code class="docutils literal notranslate"><span class="pre">B</span></code>, ... , <code class="docutils literal notranslate"><span class="pre">Y</span></code> devient <code class="docutils literal notranslate"><span class="pre">Z</span></code></p></li>
<li><p>Si <code class="docutils literal notranslate"><span class="pre">Z</span></code> est déjà affiché, on recommence à <code class="docutils literal notranslate"><span class="pre">A</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>De plus, le code ASCII de la lettre affichée doit être
représenté en binaire sur les LEDs.</p>
<blockquote>
<div><ul class="simple">
<li><p>Exemple: si <code class="docutils literal notranslate"><span class="pre">A</span></code> est affiché (soit 0x41 / 0b1000001 en ASCII), LED0 et LED6 doivent être allumée</p></li>
</ul>
</div></blockquote>
<p><strong>Note</strong>: vous pouvez trouver un exemple de police de caractère pour afficheurs
7-segments sur cette page <a class="reference external" href="https://en.wikipedia.org/wiki/Seven-segment_display_character_representations">Wikipedia</a>.
Libre à vous de vous en inspirer.</p>
<p><strong>Bonus 1</strong>: éteignez les afficheurs 7-segments et les LEDs en partant
(quand le programme est arrêté avec Ctrl+C) pour éviter de faire fondre la banquise
inutilement.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quel est le souci principal dans l'écriture de ce logiciel ?</p>
</div>
</section>
<section id="travail-a-rendre-et-criteres-d-evaluation">
<h2>Travail à rendre et critères d'évaluation<a class="headerlink" href="#travail-a-rendre-et-criteres-d-evaluation" title="Lien vers cette rubrique">#</a></h2>
<p>Dans le cadre de ce laboratoire, vous devez rendre les deux exercices relatifs à U-Boot et les exercices sous Linux.</p>
<p>S'il est demandé d'écrire du code, ce code doit se trouver dans un fichier <em>ex&lt;n&gt;.c</em>, où &lt;n&gt; correspond au numéro de l'exercice.
Si un exercice contient plusieurs variantes, alors le fichier sera nommé <em>ex&lt;n&gt;_&lt;variante&gt;.c</em>, où &lt;variante&gt; correspond à la variante.
Par exemple : <em>ex2.c</em>, <em>ex6_poll.c</em>.
Il n'est pas nécessaire de renommer les fichiers déjà existants.
Si un exercice réutilise un fichier précédent, celui-ci doit être dupliqué pour le nouvel exercice, sauf indication contraire.</p>
<p>Si le code a pour but d'être exécuté sur la DE1-SoC, il doit être compilé en &quot;compilation croisée&quot;,
c.-à-d. en utilisant la toolchain mentionnée dans le <a class="reference internal" href="#laboratoire1"><span class="std std-ref">Laboratoire 1 --- Introduction</span></a>.</p>
<p>N'oubliez pas de mettre votre prénom et nom !</p>
<p>Les exercices sont à faire <strong>individuellement</strong>.
Copier la solution d'un autre et changer le nom/l'ordre des variables n'est pas toléré.</p>
<p>La date limite est celle communiquée dans l'annonce sur Moodle.
Vous devez rendre une archive <code class="file docutils literal notranslate"><span class="pre">.tar.gz</span></code> contenant :</p>
<ul class="simple">
<li><p>le code source de vos solutions et tous les fichiers nécessaires,</p></li>
<li><dl class="simple">
<dt>un fichier <code class="file docutils literal notranslate"><span class="pre">README.md</span></code></dt><dd><ul>
<li><p>contenant les réponses aux questions posées dans les exercices.</p></li>
<li><p>les éventuels soucis rencontrés qui péjore le rendu</p></li>
<li><p>les choix d'implémentation &quot;spéciaux&quot; (si trop long pour expliquer en commentaire)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Les notes seront réparties comme suit :</p>
<ul class="simple">
<li><p>80% de la note si l'exercice est correct (c.-à-d., <em>&quot;fonctionne&quot;</em>).
Il doit bien sûr &quot;fonctionner&quot; sur d'autres PCs que votre PC personnel, et de façon déterministe.
Il est donc impératif que tout ce qui est nécessaire pour compiler et tester le fonctionnement de la solution soit rendu.</p></li>
<li><p>20% de la note si l'exercice est &quot;bien fait&quot;, c.-à-d. :</p>
<ul>
<li><p>Respect des <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html">Linux kernel coding style</a>,
particulièrement les points suivants :</p>
<ul>
<li><ol class="arabic simple">
<li><p>Indentation</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>Breaking long lines and strings</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p>Placing Braces and Spaces</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="4">
<li><p>Naming</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="6">
<li><p>Functions</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="8">
<li><p>Commenting</p></li>
</ol>
</li>
</ul>
</li>
<li><p><strong>code lisible</strong></p></li>
<li><p><strong>documenté/commenté</strong></p></li>
<li><p><strong>bien structuré</strong></p></li>
</ul>
</li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../lab_00/lab_00.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title">Laboratoire 0 --- Consolidation du langage C</p>
      </div>
    </a>
    <a class="right-next"
       href="../helper/ssh.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Mise en place de SSH sur la carte</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenu
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs">Objectifs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-de-l-environnement-de-developpement-et-prise-en-main-de-la-carte-de1-soc">Préparation de l'environnement de développement et prise en main de la carte DE1-SoC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#premieres-interactions-hw-sw">Premières interactions HW-SW</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#materiel-necessaire">Matériel nécessaire</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Préparation de l'environnement de développement et prise en main de la carte DE1-SoC</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#presentation-de-la-carte-de1-soc">Présentation de la carte DE1-SoC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-de-la-carte">Préparation de la carte</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-du-pc">Configuration du PC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-de-la-carte-sd">Préparation de la carte SD</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connexion-console-a-la-carte">Connexion console à la carte</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-des-serveurs-nfs-et-tftp">Configuration des serveurs NFS et TFTP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-reseau-de-la-machine-virtuelle">Configuration réseau de la machine virtuelle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametrage-reseau-sur-la-machine-hote">Paramétrage réseau sur la machine hôte</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-et-utilisation-de-u-boot">Configuration et utilisation de U-Boot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-des-toolchains">Vérification des toolchains</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compilation-sur-la-cible-native">Compilation sur la cible (native)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compilation-croisee-sous-de1-soc">Compilation croisée sous DE1-SoC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acces-aux-peripheriques-du-cyclonev-soc-depuis-u-boot">Accès aux périphériques du CycloneV-SoC depuis U-Boot</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exemple">Exemple</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acces-aux-peripheriques-du-de1-soc-depuis-linux">Accès aux périphériques du DE1-SoC depuis Linux</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#travail-a-rendre-et-criteres-d-evaluation">Travail à rendre et critères d'évaluation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Par REDS institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, REDS institute.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>